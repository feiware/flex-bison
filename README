
DC/OS Install on  CentOS, Service Run on DC/CS.

1. Install Docker 1.11 

   1) Upgrade CentOS to 7.2: 
$ sudo yum upgrade --assumeyes --tolerant
$ sudo yum update --assumeyes

   2) Verify that the kernel is at least 3.10: 
$ uname -r
3.10.0-327.10.1.el7.x86_64

   3) Enable OverlayFS:
$ sudo tee /etc/modules-load.d/overlay.conf <<-'EOF'
overlay
EOF

   4) Reboot to reload kernel modules:
$ reboot

   5) Verify that OverlayFS is enabled:
$ lsmod | grep overlay
overlay

   6) Configure yum to use the Docker yum repo:
$ sudo tee /etc/yum.repos.d/docker.repo <<-'EOF'
[dockerrepo]
name=Docker Repository
baseurl=https://yum.dockerproject.org/repo/main/centos/$releasever/
enabled=1
gpgcheck=1
gpgkey=https://yum.dockerproject.org/gpg
EOF

   7) Configure systemd to run the Docker Daemon with OverlayFS:
$ sudo mkdir -p /etc/systemd/system/docker.service.d && sudo tee /etc/systemd/system/docker.service.d/override.conf <<- EOF
[Service]
ExecStart=
ExecStart=/usr/bin/docker daemon --storage-driver=overlay -H fd://
EOF

   8) Install the Docker engine, daemon, and service:
$ curl -O -sSL https://yum.dockerproject.org/repo/main/centos/7/Packages/docker-engine-1.11.2-1.el7.centos.x86_64.rpm
$ sudo yum localinstall --assumeyes --tolerant docker-engine-1.11.2-1.el7.centos.x86_64.rpm
$ sudo systemctl start docker
$ sudo systemctl enable docker
Complete!
Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.

   9) Test that Docker is properly installed:
$ sudo docker ps
 
 
 2. Timeout waiting for machine to boot
   ==> boot: Waiting for machine to boot. This may take a few minutes...
       boot: SSH address: 127.0.0.1:2202
       boot: SSH username: vagrant
       boot: SSH auth method: private key
   Timed out while waiting for the machine to boot. This means that
   Vagrant was unable to communicate with the guest machine within
   the configured ("config.vm.boot_timeout" value) time period.
Solution:
   Add it to the Vagrantfile:
   Vagrant.configure("2") do |config|
     config.ssh.private_key_path = "~/.ssh/id_rsa"
     config.ssh.forward_agent = true
   end
   1) config.ssh.private_key_path is your local private key
   2) The private key must be available to the local ssh-agent. You can check with ssh-add -L, if it's not listed add it with ssh-add ~/.ssh/id_rsa
   3) Add you public key to ~/.ssh/authorized_keys on the Vagrant VM. You can do it copy-and-pasting or using a tool like ssh-copy-id
